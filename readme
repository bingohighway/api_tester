#!/bin/zsh

echo "Creating the main documentation file: README.md..."

# This script is formatted to avoid issues with backticks in web browsers
cat > README.md << 'EOF'
# WAF & API Gateway Testing Suite

This project provides a comprehensive suite of tools designed to test the functionality, security contract enforcement, and performance of Web Application Firewalls (WAFs) and API Gateways.

This suite was generated on Friday, 10 October 2025.

## Features

**Test API Server (`api.py`)**
- A versatile Flask API with multiple endpoints for testing different scenarios.
- Endpoints to test signature-based blocking (`/pattern-check`) vs. contract-based blocking (`/pattern-check-contract`).
- Serves its own OpenAPI contract at `/contract` and a human-readable guide at `/usage`.

**Performance Tester (`perf_tester.py`)**
- Measures detailed connection metrics (DNS, TCP, TLS, TTFB, Total Time).
- Renders a live, full-history ASCII line graph in the terminal for each endpoint.
- Saves all raw results to a CSV file, including a snippet of the response body.

**Functional Tester (`tester.py`)**
- A simple script to quickly verify that the main API endpoints are online and security rules are functioning.

## Setup & Usage

Full setup and usage instructions are available in the [main README file](https://github.com/your-repo/your-project/blob/main/README.md).
EOF
echo '```' >> README.md
cat >> README.md << 'EOF'
## API Endpoint Details (`api.py`)

The test API provides the following endpoints. A live version of this guide is available at `http://127.0.0.1:5000/usage`.

| Endpoint                    | Method | Description                                                  | Contract Limits                                        |
| --------------------------- | ------ | ------------------------------------------------------------ | ------------------------------------------------------ |
| `/pattern-check`            | POST   | Checks input against suspicious patterns (loose contract).   | N/A                                                    |
| `/pattern-check-contract`   | POST   | Checks input against suspicious patterns (strict contract).  | Max length: 50, alphanumeric chars only                |
| `/usage`                    | GET    | Provides a human-readable summary of all endpoints.          | N/A                                                    |
| `/capabilities`             | GET    | Describes all available endpoints in OpenAPI format.         | N/A                                                    |
| `/delay/{milliseconds}`     | GET    | Delays the response by a specified time.                     | Max value: 60000, Min value: 0                         |
| `/headers`                  | GET    | Reflects request headers.                                    | N/A                                                    |
| `/response-code/{code}`     | GET    | Returns a specific HTTP response code.                       | Max value: 599, Min value: 100                         |
| `/tight-echo`               | POST   | Echos a string with a very strict contract.                  | Max length: 50, alphabetic chars only                  |
| `/loose-echo`               | POST   | Echos a string with a looser contract.                       | Max length: 50, alphanumeric chars only                |
| `/random`                   | GET    | Returns a random string with a strict contract length.       | Max value: 50                                          |
| `/contract`                 | GET    | Returns the full OpenAPI contract for this API.              | N/A                                                    |
| `/chars-contract`           | POST   | Accepts only alphanumeric strings, enforced by contract.     | Max length: 50, alphanumeric chars only                |
EOF
echo '```' >> README.md

echo "README.md file created successfully!"
